<script>
  const KEY = 'projectId'
  let params = new URLSearchParams(location.search)
  let entries = Object.fromEntries(params)
  let redirectUrl
  if (entries.projectId == undefined) {
    redirectUrl = `https://script.google.com/macros/d/${localStorage.getItem(KEY)}/usercallback${location.search}`
    localStorage.removeItem(KEY)
  } else {
    redirectUrl = entries.redirect
    localStorage.setItem(KEY, entries.projectId)
  }
  // window.open(redirectUrl, "_self")
</script>
